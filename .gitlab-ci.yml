image: golang:1.21

variables:
  CPX_VERSION: latest

before_script:
  - apt-get update && apt-get install -y curl docker.io
  - systemctl start docker || true
  - curl -fsSL https://raw.githubusercontent.com/ozacod/cpx/main/install.sh | sh
  - export PATH="$HOME/.local/bin:$PATH"

build:
  stage: build
  script:
    - cpx ci
  artifacts:
    paths:
      - out
    expire_in: 1 week
